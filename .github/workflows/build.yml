name: Build Windows EXE

on: [push]

jobs:
  build:
    runs-on: windows-latest
    
    steps:
    - name: Create C++ source file
      run: |
        # PowerShell version
        @'
#include <windows.h>
int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow) {
    MessageBox(NULL, L"GOD MODE V9.0\nBuilt with GitHub Actions", L"âœ… Success", MB_OK);
    return 0;
}
'@ | Out-File -FilePath "program.cpp" -Encoding ASCII
    
    - name: Compile to EXE
      shell: cmd
      run: |
        echo Setting up Visual Studio...
        call "C:\Program Files\Microsoft Visual Studio\2022\Enterprise\VC\Auxiliary\Build\vcvars64.bat"
        
        echo Compiling...
        cl program.cpp /Fe:program.exe /EHsc /nologo
        
        if exist program.exe (
          echo COMPILATION SUCCESSFUL
          dir program.exe
        ) else (
          echo COMPILATION FAILED
          exit 1
        )
    
    - name: Upload executable
      uses: actions/upload-artifact@v4
      with:
        name: Windows-Program
        path: program.exe
