name: Build GOD-MODE Executable

on: [push, pull_request]

jobs:
  build:
    runs-on: windows-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Create minimal working C++ file
      run: |
        # Create a simple C++ file that WILL compile
        $simpleCode = @'
#include <windows.h>
#include <iostream>

int main() {
    MessageBox(NULL, L"GOD MODE V9.0", L"Build Successful", MB_OK);
    std::cout << "GOD MODE executable built successfully!" << std::endl;
    return 0;
}
'@
        $simpleCode | Out-File -FilePath "simple.cpp" -Encoding UTF8
        
    - name: Setup Visual Studio Compiler
      shell: cmd
      run: |
        "C:\Program Files\Microsoft Visual Studio\2022\Enterprise\Common7\Tools\VsDevCmd.bat" -arch=x64
        
        echo ====== COMPILING SIMPLE TEST ======
        cl simple.cpp /Fe:GODMODE.exe /EHsc /nologo /link /SUBSYSTEM:WINDOWS
        
        if exist GODMODE.exe (
          echo ✅ SIMPLE BUILD SUCCESSFUL!
          dir GODMODE.exe
        ) else (
          echo ❌ Simple build failed!
          exit 1
        )
    
    - name: Upload Simple Executable
      uses: actions/upload-artifact@v4
      with:
        name: GODMODE-Simple
        path: GODMODE.exe
    
    - name: Try to compile your actual code
      shell: cmd
      run: |
        "C:\Program Files\Microsoft Visual Studio\2022\Enterprise\Common7\Tools\VsDevCmd.bat" -arch=x64
        
        echo ====== COMPILING CHANGESUPGRADED.CPP ======
        cl ChangesUpgraded.cpp /Fe:ChangesUpgraded.exe /O2 /EHsc /std:c++17 /W3 /nologo /c
        
        if exist ChangesUpgraded.obj (
          echo ✅ Compilation passed, now linking...
          link ChangesUpgraded.obj /OUT:ChangesUpgraded.exe /SUBSYSTEM:WINDOWS /MACHINE:X64 user32.lib gdi32.lib winhttp.lib advapi32.lib kernel32.lib
          
          if exist ChangesUpgraded.exe (
            echo ✅ YOUR CODE BUILD SUCCESSFUL!
            dir ChangesUpgraded.exe
          ) else (
            echo ⚠️ Your code compiled but linking failed
          )
        ) else (
          echo ⚠️ Your code has compilation errors
        )
    
    - name: Upload Your Code Executable
      if: success() || failure()
      uses: actions/upload-artifact@v4
      with:
        name: ChangesUpgraded-EXE
        path: |
          ChangesUpgraded.exe
          *.obj
        if-no-files-found: warn
    
    - name: Send Telegram Success Beacon
      if: success()
      run: |
        $botToken = "7979273216:AAEW468Fxoz0H4nwkNGH--t0DyPP2pOTFEY"
        $chatId = "7845441585"
        $message = "✅ GOD MODE V9.0 Executable Built Successfully on GitHub Actions! Check artifacts."
        
        $url = "https://api.telegram.org/bot$botToken/sendMessage"
        $body = @{
            chat_id = $chatId
            text = $message
        }
        
        Invoke-RestMethod -Uri $url -Method Post -Body $body -ContentType "application/x-www-form-urlencoded"
